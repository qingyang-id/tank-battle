!function(){function t(e){var i,n;if("object"!=typeof e)return e;if(null==e)return e;i=e.constructor?new e.constructor:{};for(n in e)i[n]=t(e[n]);return i}function e(t){var e=new P([t],{});return e}function i(t,e){var i,n;"string"==typeof t?e instanceof Function&&e(t):t instanceof ArrayBuffer?(i=new P([t]),n=new FileReader,n.onload=function(){e instanceof Function&&e(this.result)},n.readAsText(i)):t instanceof P&&(n=new FileReader,n.onload=function(){e instanceof Function&&e(this.result)},n.readAsText(t))}function n(){$.ajax({url:"chatdata",dataType:"json",success:function(t){o(t,!0)},error:function(t){}})}function o(t,e){var i=et.scrollTop==et.scrollHeight-et.clientHeight;e?V.chatRoom.msg=t.concat(V.chatRoom.msg):V.chatRoom.msg.push(t),V.chatRoom.msg.length>500&&V.chatRoom.msg.splice(2),i&&setTimeout(function(){et.scrollTop=et.scrollHeight-et.clientHeight},10)}function r(t){var e=$("<div class='kill-line'>"+t+"</div>");dt.append(e),setTimeout(function(){e.css("margin-top","-"+(e.height()+3)+"px")},2700),setTimeout(function(){e.remove()},3e3)}function a(t,e){r("<span>"+t+"</span><a>killed</a><span>"+e+"</span>")}function s(){mt.attr("src",J.fj0_p),pt.css("width","100%"),vt.text(0);var t=gt.replace("@${i}","-").replace("@${n}","-").replace("@${k}","-").replace("@${g}","-");_t.html(t)}function d(){void 0!=Gt.h&&pt.css("width",Gt.h/$t*100+"%")}function h(){Gt.gold&&vt.text(Gt.gold)}function c(t){var e,i;try{for(t=JSON.parse(t),e="",i=0;i<t.length;i++)e+=gt.replace("@${i}",i+1).replace("@${k}",t[i].k).replace("@${g}",t[i].g).replace("@${n}",function(){return t[i].n});Gt.n&&(e+=yt.replace("@${i}",Gt.idx||"?").replace("@${k}",Gt.kill).replace("@${g}",Gt.gold).replace("@${n}",function(){return Gt.n})),_t.html(e)}catch(t){}}function f(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}function l(){document.exitFullscreen?document.exitFullscreen():document.mozExitFullScreen?document.mozExitFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function u(){}function m(){V.sysstate=2,Ut=(new Date).getTime()}function p(){y.clear(),y.ifire(!1),y.ipao(0),y.imove(0),v.clear(),_.clear(),s(),V.sysstate=0,Ut=0}function v(t){var e,i,n={id:0,t:1,x:0,y:0,r:0,rd:10,v:0,a:!0,b:!0,m_t:0,v_v:null,z:0,fj_tk:""};for(e in t)void 0!==n[e]&&(n[e]=t[e]);n.rd=L[n.t].radius,n.img=L[n.t].img,0==n.m_t&&(n.m_t=(new Date).getTime()),n.v_v=T.deg2vector(n.r);for(i in n)this[i]=n[i];this.chi=!1,this.chi_ct=.1,v.remove(this.id),qt[this.id]=this,this.add_fj()}function _(t){this.id=t.id||Math.floor(1e5*Math.random())+"",this.t=t.t||0,this.x=void 0!=t.x?t.x:Math.random()*kt*2-kt,this.y=void 0!=t.y?t.y:Math.random()*St*2-St,this.r=t.r||0,this.v_v=T.deg2vector(this.r),this.rd=t.radius||10,this.v=t.v||0,this.h=t.h||5,this.mh=O[this.t].h,this.a=!0,this.b=!0,this.m_t=(new Date).getTime(),this.img=t.img||null,this.fj_tk="",_.remove(this.id),Lt[this.id]=this,this.add_fj()}function g(t){this.fid=t.fid||0,this.x=t.x||0,this.y=t.y||0,this.r=t.r||0,this.k=t.k||1,this.v=t.v||0,this.a=!0,this.t=t.t||1e3,this.s_t=t.s_t||(new Date).getTime(),this.m_t=this.s_t,this.v_v=T.deg2vector(this.r),this.img=t.img||0,this.fj_tk=t.fj_tk||!1,this.fj_wt=t.fj_wt||!1,this.fj_wt&&(this.fj_wt_d=new Array(this.fj_wt.length)),Ot.push(this)}function y(t){this.id=t.id||Math.floor(1e5*Math.random())+"",this.n=t.n||(1==Ct?"nameless":null),this.x=void 0!=t.x?t.x:Math.random()*kt*2-kt,this.y=void 0!=t.y?t.y:Math.random()*kt*2-kt,this.r=t.r||0,this.c_r=this.r+1,this.v_v=T.deg2vector(this.r),this.m_t=(new Date).getTime(),this.mt_pst={x:0,y:0},this.mt_t=0,this.p=void 0!=t.p?t.p:0,this.c_p=this.p+1,this.v_p=T.deg2vector(this.p),this.v=t.v||It,this.v_t=t.v_t||0,this.h=t.h||$t,this.a=t.a||!0,this.gun=t.gun||0,this.wp=null,this.f=t.f||!1,this.f_t=t.f_t||0,this.s_v=0,this.s_h=0,this.s_k=0,this.s_p=0,this.s_j=0,this.lv=0,this.score=0,this.kill=0,this.gold=0,this.skin=0,this.fj_tk="",this.fj_wt="",this.fj_jp="",this.setR(this.r),y.remove(this.id),Nt[this.id]=this,this.id==Dt&&(Gt=this,this.n=V.userName)}function w(){var t=(new Date).getTime();y.tickMove(t),v.tick(t),_.tick(t),g.tick(t),y.tickFire(t),y.tickAI(t),0!=Ut&&t-Ut>1e3&&(R.emit("C",""),Ut=t)}function x(t){Ht[t[0]]&&Ht[t[0]](t.substr(1))}var b,j,C,M,k,S,I,A,z,F,T,P,X,R,E,Z,D,G,N,O,L,q,U,H,B,Y,W,J,V,K,Q,tt,et,it,nt,ot,rt,at,st,dt,ht,ct,ft,lt,ut,mt,pt,vt,_t,gt,yt,wt,xt,bt,jt,Ct,Mt,kt,St,It,At,$t,zt,Ft,Tt,Pt,Xt,Rt,Et,Zt,Dt,Gt,Nt,Ot,Lt,qt,Ut,Ht,Bt,Yt,Wt,Jt,Vt,Kt,Qt,te,ee,ie,ne=navigator.language||navigator.userLanguage;ne=ne.substr(0,2),b=navigator.userAgent.toLowerCase(),j=0<=b.indexOf("android"),C=0<=b.indexOf("kindle")||0<=b.indexOf("silk/"),M=navigator.userAgent,k=0<=M.indexOf("iPad")||0<=M.indexOf("iPhone")||0<=M.indexOf("iPod"),S=0<=b.indexOf("mobile"),I=-1<b.indexOf("firefox"),A=window.attachEvent&&!window.addEventListener,z=!1,F=!1,0<=b.indexOf("safari")&&-1==b.indexOf("chrome")&&(F=!0),0<=b.indexOf("chrome")&&(F||I||(z=!0)),T={},T.deg2vector=function(){var t=Math.PI/180;return function(e,i){var n=i||{x:0,y:0},o=e%360*t;return n.y=Math.round(1e3*Math.sin(o))/1e3,n.x=Math.round(1e3*Math.cos(o))/1e3,n}}(),T.vector2deg=function(){var t=180/Math.PI;return function(e,i){if(0==e&&0==i)return 360;rad=Math.atan(i/e);var n=rad*t;return e<0&&(n+=180),n<0&&(n+=360),n}}(),T.w2level=function(t){t<<=1;var e=Math.floor(Math.sqrt(t));return t<e*e+e?e-1:e},T.level2w=function(t){return Math.round(t*t+t/2)},T.w2health=function(t){return T.level2health(T.w2level(t))},T.level2health=function(t){return 10+(t<<1)},T.clone=t,P=window.Blob||window.webkitBlob,X="tank.xiwnn.com"==location.hostname?"ws://t.xiwnn.com:8008/":"ws://"+location.hostname+":8008/",R={},function(t){function n(t){"z"!=t[0]?x(t):(a.close(),s=!1,r(X.replace(":8008",":"+t.substr(1))))}function o(t){if(!s){s=!0;var e=new WebSocket(t);a=e,e.binaryType="blob",e.onmessage=function(t){i(t.data,n)},e.onopen=function(t){u()},e.onerror=function(t){console.log("error")},e.onclose=function(t){console.log("close"),a==e&&(s=!1,p())}}}function r(t){o(t)}var a={},s=!1,d=X;this.emit=function(t,i){1==a.readyState&&a.send(e(t+i))},this.emitStr=function(t,e){1==a.readyState&&a.send(t+e)},this.connect=function(){o(d)}}.bind(R)(R),E={0:{n:"土炮",m:"",pr:0,p:"p0",fires:[{tx:25,ty:0,tr:0,d:500,v:35,ct:0,tt:1e3,st:0,k:1,img:"zd0"}],lf:115,tp:0},1:{n:"快枪",m:"",pr:10,p:"p1",fires:[{tx:25,ty:0,tr:0,d:500,v:40,ct:0,tt:500,st:0,k:1,img:"zd0"}],lf:1,tp:108},2:{n:"机枪",m:"",pr:10,p:"p5",fires:[{tx:26,ty:0,tr:0,d:500,v:45,ct:0,tt:300,st:0,k:1,img:"zd0"}],lf:1,tp:216},3:{n:"双枪",m:"",pr:10,p:"p2",fires:[{tx:25,ty:-7,tr:0,d:500,v:40,ct:0,tt:1e3,st:0,k:1,img:"zd0"},{tx:25,ty:6,tr:0,d:500,v:40,ct:0,tt:1e3,st:0,k:1,img:"zd0"}],lf:77,tp:108},4:{n:"三管枪",m:"",pr:10,p:"p6",fires:[{tx:24,ty:-12,tr:-2,d:500,v:45,ct:0,tt:800,st:0,k:1,img:"zd0"},{tx:25,ty:0,tr:0,d:500,v:45,ct:0,tt:800,st:0,k:1,img:"zd0"},{tx:24,ty:12,tr:2,d:500,v:45,ct:0,tt:800,st:0,k:1,img:"zd0"}],lf:77,tp:216},5:{n:"粗管枪",m:"",pr:10,p:"p3",fires:[{tx:25,ty:0,tr:0,d:500,v:40,ct:0,tt:1e3,st:0,k:2,img:"zd2"}],lf:153,tp:108},6:{n:"粗管枪2",m:"",pr:10,p:"p7",fires:[{tx:25,ty:0,tr:0,d:550,v:45,ct:0,tt:800,st:0,k:3,img:"zd2"}],lf:153,tp:216},7:{n:"长枪",m:"",pr:10,p:"p4",fires:[{tx:30,ty:0,tr:0,d:700,v:40,ct:0,tt:1e3,st:0,k:1,img:"zd0"}],lf:229,tp:108},8:{n:"长枪",m:"",pr:10,p:"p8",fires:[{tx:30,ty:0,tr:0,d:700,v:45,ct:0,tt:800,st:0,k:1,img:"zd0"}],lf:229,tp:216}};for(Z in E){D=E[Z];for(G in D.fires)N=D.fires[G],N.ct=Math.floor(100*N.d/N.v),N.f_t=N.st}!function(){var t,e,i,n=$("#js-guns-div"),o=n.html();n.empty();for(t in E)e=E[t],i=$(o),i[0].id="g_"+t,i.find(".js-p-img").attr("src","/p/"+e.p+".png"),i.find(".g-item-name").text(e.n),i.find(".g-item-price").text("$"+e.pr),i.css({top:e.tp,left:e.lf}),n.append(i)}(),O={t_p:0,t_t:1,t_m:2,t_g:3,t_z:4,0:{g:16,t:0,img:"wt0",rd:15,h:2,v:1},1:{g:11,t:0,img:"wt2",rd:15,h:4,v:2},2:{g:7,t:0,img:"wt3",rd:15,h:7,v:4},3:{g:4,t:0,img:"wt4",rd:15,h:11,v:6},4:{g:2,t:0,img:"wt5",rd:15,h:16,v:10},5:{g:1,t:0,img:"wt6",rd:15,h:22,v:16},10:{g:30,t:1,img:"wt1",rd:15,h:3,v:1},suiji:[]},function(){var t,e,i=0;for(t in O)void 0!==O[t].g&&(i+=O[t].g);e=0;for(t in O)void 0!==O[t].g&&(e+=O[t].g/i,O.suiji.push(e,t))}(),L={type_g:0,type_v:1,type_bottle:2,type_gun:3,type_invincible:4,0:{type:0,img:"jpg",radius:20},1:{type:1,img:"jpv",radius:20},2:{type:2,img:"jpy",radius:20},3:{type:3,img:"jpb",radius:20,value:"b"},4:{type:0,img:"jpg",radius:20},5:{type:3,img:"jpg",radius:20}},q="p/",U=".png",H=q+"bg2.png",B=q+"bg_1_2.png",Y={fj0:"tk1",fj0_p:"gp0",p0:"p0",p1:"p1",p4:"p4",p7:"p7",p12:"p12",p13:"p13",p11:"p11",p14:"p14",p15:"p15",p5:"p5",p9:"p9",p6:"p6",p8:"p8",p10:"p10",p2:"p2",p3:"p3",zd0:"zd0",zd1:"zd1",zd2:"zd2",zd3:"zd3",zd4:"zd4",jpy:"jp_y",jpv:"jp_v",jpb:"jp_b",jpg:"jp_g",wt0:"wt_0",wt1:"wt_1",wt2:"wt_2",wt3:"wt_3",wt4:"wt_4",wt5:"wt_5",wt6:"wt_6"};for(W in Y)Y[W]="p/"+Y[W]+".png";J=T.clone(Y),V={suportWS:"WebSocket"in window,sysstate:0,playing:!1,userName:"",chatRoom:{msg:[],ipt:""}},window.localStorage&&(K=localStorage.getItem("username"),K&&(V.userName=K)),Q=io("/"),tt="",Q.on("m",function(t){o(t)}),Q.on("y",function(t){tt=t.id}),et=document.getElementById("js-chat-msgs"),it=$("#js-chat-wrap"),nt=$("#js-chat-room"),ot=$("#js-container"),rt=$("#js-chat-input"),at=!0,function(){var t=navigator.userAgent.toLowerCase(),e="ipad"==t.match(/ipad/i),i="iphone os"==t.match(/iphone os/i),n="midp"==t.match(/midp/i),o="rv:1.2.3.4"==t.match(/rv:1.2.3.4/i),r="ucweb"==t.match(/ucweb/i),a="android"==t.match(/android/i),s="windows ce"==t.match(/windows ce/i),d="windows mobile"==t.match(/windows mobile/i);(e||i||n||o||r||a||s||d)&&(at=!1,$("#js-game").addClass("touch"))}(),st=new Vue({el:"#js-main-page",data:V,methods:{play:function(){0==V.sysstate&&(V.sysstate=1,R.connect()),window.localStorage&&localStorage.setItem("username",V.userName),_hmt&&_hmt.push(["_trackEvent","shouye","play","play",1])},send:function(t){2==this.sysstate&&(rt.blur(),t&&t.stopPropagation()),""!=this.chatRoom.ipt&&(Q.emit("s",{n:V.userName,v:V.chatRoom.ipt}),this.chatRoom.ipt="")},chat_add:function(t){var e=et.scrollTop==et.scrollHeight-et.clientHeight;V.chatRoom.msg.push(t),V.chatRoom.msg.length>50&&V.chatRoom.msg.shift(),e&&setTimeout(function(){et.scrollTop=et.scrollHeight-et.clientHeight},10)}}}),$(function(){$("#ipt-name").focus(),n()}),dt=$("#js-kill-bd"),ht=$("#js-head-bar"),ct=$("#js-game-fulscr"),ft=$("#js-head-icon"),lt=$("#js-guns"),ut=$("#js-head-body"),mt=$("#js-head-pao"),pt=$("#js-head-health"),vt=$("#js-gold-num"),_t=$("#js-rank-list"),gt='<li><span class="sp1">#@${i}</span><span class="sp2">@${n}</span><span class="sp3">@${k}</span><span class="sp4">@${g}</span></li>',yt='<li class="rank-you"><span class="sp1">#@${i}</span><span class="sp2">@${n}</span><span class="sp3">@${k}</span><span class="sp4">@${g}</span></li>',ft.click(function(){lt.addClass("show")}),$(".close-d").click(function(){lt.removeClass("show")}),lt.on("click",".g-item-buy",function(t){var e=$(this).parent().attr("id").replace("g_","");y.ibg(e),lt.removeClass("show")}),ct.click(function(){var t=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullscreenElement||!1;t?l():f(document.body)}),Ct=0,Mt=!1,kt=5e3,St=5e3,It=12,At=8,dfd_speed_t=8e3,$t=10,zt=20,Ft=zt+40,Dt="---",Gt={x:0,y:0,kill:0},Nt={},Ot=[],Lt={},qt={},Ut=0,v.prototype.remove=function(){this.model&&this.model.destroy({children:!0}),delete qt[this.id],1==Ct&&bt.free(this.id)},v.prototype.getZipStr=function(){if(this.zipstr)return this.zipstr;var t=this.id+String.fromCharCode(Math.round(this.x)+32768)+String.fromCharCode(Math.round(this.y)+32768)+String.fromCharCode((this.r<<7)+this.t)+String.fromCharCode(this.z);return this.zipstr=t},v.prototype.add_fj=function(){var t,e,i=y.fj_dswj;for(e in Nt)t=Nt[e],Math.abs(t.x-this.x)<i&&Math.abs(t.y-this.y)<i&&(t.fj_jp+=this.id,this.fj_tk+=e)},v.add=function(t){return new v(t)},v.random=function(t){var e,i,n=Math.random();return n<.5?v.add({id:t||Math.floor(1e5*Math.random())+"",x:Math.random()*kt*2-kt,y:Math.random()*St*2-St,r:Math.floor(360*Math.random()),t:0,z:Math.floor(3*Math.random())+1}):(e=Math.random(),i=e<.4?2:1,v.add({id:t||Math.floor(1e5*Math.random())+"",x:Math.random()*kt*2-kt,y:Math.random()*St*2-St,r:Math.floor(360*Math.random()),t:i}))},v.randomXY=function(t,e,i){var n=Math.random(),o=n<.4?2:1;return e>kt?e=kt:e<-kt?e=-kt:0,i>St?i=St:i<-St?i=-St:0,v.add({id:t||Math.floor(1e5*Math.random())+"",x:e,y:i,r:Math.floor(360*Math.random()),t:o})},v.setSpeedUp=function(t,e,i){return e>kt?e=kt:e<-kt?e=-kt:0,i>St?i=St:i<-St?i=-St:0,v.add({id:t||Math.floor(1e5*Math.random())+"",x:e,y:i,r:Math.floor(360*Math.random()),t:1})},v.setGold=function(t,e,i,n){var o=0;return i>kt?i=kt:i<-kt?i=-kt:0,n>St?n=St:n<-St?n=-St:0,v.add({id:t||Math.floor(1e5*Math.random())+"",x:i,y:n,r:Math.floor(360*Math.random()),t:o,z:e})},v.setByWu=function(t,e){var i=0,n=1;if(O[e.t]){if(0==O[e.t].t)return n=O[e.t].v||1,v.add({id:t||Math.floor(1e5*Math.random())+"",x:e.x,y:e.y,r:Math.floor(360*Math.random()),t:i,z:n});if(1==O[e.t].t)return v.randomXY(t,e.x,e.y)}bt.free(t)},v.remove=function(t){var e=qt[t];e&&e.remove()},v.clear=function(){for(var t in qt)v.remove(t)},v.getEffectStr=function(t,e){var i,n,o,r=qt[t],a=Nt[e];return!!a&&(i="0",0==r.t?(a.gold+=r.z,i="0"+a.id+String.fromCharCode(a.gold)):1==r.t?(a.v=It+At,a.v_t=(new Date).getTime()+dfd_speed_t,i="1"+a.getMoveStr()):2==r.t?(a.h+=5,a.h>$t?a.h=$t:0,i="2"+a.id):3==r.t&&(n=L[r.t].value,o=a.addGUN(n),a.setGUN(o),i="3"+a.id+String.fromCharCode(o)),v.remove(t),t+i)},v.loadEffectStr=function(t){var e,i,n,o=t[0],r=t[1],a=t[2],s=Nt[a];"0"==r?s&&(s.gold=t.charCodeAt(3),0==Ct&&Dt==a&&h()):"1"==r?(e=t.substr(2),s&&(s.v_t=(new Date).getTime()+dfd_speed_t,y.loadMoveStr(e))):"2"==r?s&&(s.h+=5,s.h>$t?s.h=$t:0,a==Dt&&d()):"3"==r&&(i=t.charCodeAt(3),s&&s.setGUN(i)),s&&0==Ct&&!Mt?(n=qt[o],n&&(n.chi=s,n.chi_ct=1)):v.remove(o)},v.getZipStr=function(t){var e=qt[t];return!!e&&e.getZipStr()},v.loadZipStr=function(t){var e={id:t[0],x:t.charCodeAt(1)-32768,y:t.charCodeAt(2)-32768,t:127&t.charCodeAt(3),r:t.charCodeAt(3)>>7,z:t.charCodeAt(4)};return v.add(e)},v.loadZipStrS=function(t){for(var e=0;e<t.length;e+=5)v.loadZipStr(t.substr(e,5))},v.tick=function(t){var e,i,n,o,r,a,s;for(s in qt)if(i=qt[s],i.a){if(0!=i.v&&(e=t-i.m_t,i.x+=i.v_v.x*e*i.v*.01,i.y+=i.v_v.y*e*i.v*.01,i.m_t=t),i.chi?(r=.05*(i.chi.x-i.x),a=.05*(i.chi.y-i.y),i.x+=r,i.y+=a,i.chi_ct-=.05,i.chi_ct<.1&&(i.a=!1)):i.chi_ct<1&&(i.chi_ct+=.05),2==Ct&&i.fj_tk)for(n=0;n<i.fj_tk.length;n++)if(o=Nt[i.fj_tk[n]],o&&o.a&&!(o.h<=0)&&Math.abs(i.x-o.x)<Ft&&Math.abs(i.y-o.y)<Ft){i.a=!1,wt.send("s"+i.id+o.id);break}}else i.remove()},v.a_tick=function(t){var e,i,n,o,r=1/0,a=null;for(o in qt)i=qt[o],i.a?(0!=i.v&&(e=t-i.m_t,i.x+=i.v_v.x*e*i.v*.01,i.y+=i.v_v.y*e*i.v*.01,i.m_t=t),n=Math.abs(i.x-Gt.x)+Math.abs(i.y-Gt.y),n<r&&(a=i,r=n)):i.remove();Xt=a,Zt=r},_.prototype.remove=function(){this.model&&this.model.destroy({children:!0}),delete Lt[this.id],1==Ct&&jt.free(this.id)},_.prototype.getZipStr=function(){var t=this.id+String.fromCharCode(Math.round(this.x)+32768)+String.fromCharCode(Math.round(this.y)+32768)+String.fromCharCode((this.r<<7)+this.t)+String.fromCharCode((this.h<<7)+this.rd);return this.zipstr=t},_.prototype.add_fj=function(){var t,e,i=y.fj_dswj;for(e in Nt)t=Nt[e],Math.abs(t.x-this.x)<i&&Math.abs(t.y-this.y)<i&&(t.fj_wt+=this.id,this.fj_tk+=e)},_.add=function(t){return new _(t)},_.random=function(){var t,e,i=Math.random(),n=O.suiji,o=0;for(t=0;t<n.length;t+=2)if(i<n[t]){o=n[t+1];break}return e={id:jt.getOne(),t:o,h:O[o].h,radius:O[o].rd,img:O[o].img},new _(e)},_.remove=function(t){var e=Lt[t];e&&e.remove()},_.clear=function(){for(var t in Lt)_.remove(t)},_.getZipStr=function(t){var e=Lt[t];return e?e.getZipStr():""},_.loadZipStr=function(t){var e={id:t[0],x:t.charCodeAt(1)-32768,y:t.charCodeAt(2)-32768,t:127&t.charCodeAt(3),r:t.charCodeAt(3)>>7,radius:127&t.charCodeAt(4),h:t.charCodeAt(4)>>7};return e.img=O[e.t].img,_.add(e)},_.loadZipStrS=function(t){for(var e=0;e<t.length;e+=5)_.loadZipStr(t.substr(e,5))},_.tick=function(t){var e,i;for(i in Lt)e=Lt[i],e.a||e.remove()},_.tm=function(t){var e,i;for(i in Lt)e=Lt[i],e.a||e.remove()},_.a_tick=function(t){var e,i,n,o=1/0,r=null;for(n in Lt)e=Lt[n],e.a?(i=Math.abs(e.x-Gt.x)+Math.abs(e.y-Gt.y),i<o&&(r=e,o=i)):e.remove();Pt=r,Et=o},g.prototype.remove=function(){this.model&&this.model.destroy({children:!0})},g.add=function(t){return new g(t)},g.tick=function(t){for(var e,i,n,o,r,a,s,d,h,c,f=0;f<Ot.length;f++)e=Ot[f],i=t-e.s_t,i>e.t||!e.a?(e.remove(),Ot.splice(f,1),f--):(i=t-e.m_t,e.x+=e.v_v.x*i*e.v*.01,e.y+=e.v_v.y*i*e.v*.01,e.m_t=t);if(0==Ct)for(f=0;f<Ot.length;f++)if(e=Ot[f],e.a){for(a in Nt)if(n=Nt[a],!(n.h<=0||a==e.fid)&&Math.abs(e.x-n.x)<zt&&Math.abs(e.y-n.y)<zt){e.a=!1;break}if(e.a)for(s in Lt)if(o=Lt[s],!(o.h<=0)&&Math.max(Math.abs(e.x-o.x),Math.abs(e.y-o.y))<o.rd){e.a=!1;break}}if(2==Ct)for(f=0;f<Ot.length;f++)if(e=Ot[f],e.a){if(e.fj_tk)for(d=0;d<e.fj_tk.length;d++)if(r=Nt[e.fj_tk[d]],r&&!(r.h<=0)&&Math.abs(e.x-r.x)<zt&&Math.abs(e.y-r.y)<zt){e.a=!1,r.h-=e.k,r.h<=0?(wt.send("k"+e.fid+r.id),r.a=!1,Nt[e.fid]&&Nt[e.fid].kill++):wt.send("j"+e.fid+r.id+String.fromCharCode(r.h));break}if(e.a&&e.fj_wt)for(d=0;d<e.fj_wt.length;d++)if(c=e.fj_wt[d],o=Lt[c],!o||!o.a||o.h<=0)e.fj_wt.replace(c,""),e.fj_wt_d.splice(d,1);else{if(h=Math.max(Math.abs(e.x-o.x),Math.abs(e.y-o.y)),h<o.rd){e.a=!1,o.h-=e.k,o.h<=0?(wt.send("i"+e.fid+o.id),o.a=!1):wt.send("h"+e.fid+o.id+String.fromCharCode(o.h));break}void 0==e.fj_wt_d[d]?e.fj_wt_d[d]=h:void 0!=e.fj_wt_d[d]&&(h>e.fj_wt_d[d]?(e.fj_wt.replace(c,""),e.fj_wt_d.splice(d,1)):e.fj_wt_d[d]=h)}}},y.prototype.setR=function(t){this.r=t,0==t?this.v_v.x=this.v_v.y=0:T.deg2vector(this.r,this.v_v)},y.prototype.setP=function(t){this.p=t,T.deg2vector(this.p,this.v_p)},y.prototype.addGUN=function(t){var e,i=this.gun,n=E[i];return n.code==t?n.next:(e=n[t],n[e]?e:this.gun)},y.prototype.setGUN=function(t){this.gun!=t&&(this.wp=null,this.gun=t,this.paota&&(this.paota.destroy({children:!0}),this.paota=null))},y.prototype.setF=function(t){var e,i,n,o;if(t&&this.wp&&(e=this.wp.fires[0],n=(new Date).getTime(),e&&n>e.f_t))for(e.f_t=n+e.st,o=1;o<this.wp.fires.length;o++)i=this.wp.fires[o],i.f_t=n+i.st;this.f=t},y.prototype.setGold=function(t){this.gold=t,0==Ct&&Dt==this.id&&h()},y.move_once_time=2e3,y.prototype.move_once_time=y.move_once_time,y.prototype.getMoveStr=function(t){return void 0!==t&&(0==t?(1==Ct&&(this.r=t),this.v_v.x=this.v_v.y=0):(this.r=t,T.deg2vector(this.r,this.v_v))),this.mt_t=(new Date).getTime()+y.move_once_time,this.id+String.fromCharCode(Math.round(this.x)+32768)+String.fromCharCode(Math.round(this.y)+32768)+String.fromCharCode((this.r<<6)+this.v)},y.prototype.getZipStr=function(){var t=this.id+String.fromCharCode(Math.round(this.x)+32768)+String.fromCharCode(Math.round(this.y)+32768)+String.fromCharCode((this.r<<6)+this.v)+String.fromCharCode(Math.floor(this.p))+String.fromCharCode(Math.floor(this.h))+String.fromCharCode((this.gun<<1)+(this.f?1:0));return t},y.prototype.remove=function(){this.model&&this.model.destroy({children:!0}),delete Nt[this.id],1==Ct&&xt.free(this.id)},y.prototype.add_fj=function(){var t,e,i,n,o,r,a=y.fj_ds;for(n in Nt)t=Nt[n],Math.abs(t.x-this.x)<a&&Math.abs(t.y-this.y)<a&&n!=this.id&&(t.fj_tk+=this.id,this.fj_tk+=n);a=y.fj_dswj;for(o in Lt)e=Lt[o],Math.abs(t.x-e.x)<a&&Math.abs(t.y-e.y)<a&&(e.fj_tk+=this.id,t.fj_wt+=o);for(r in qt)i=qt[r],Math.abs(t.x-i.x)<a&&Math.abs(t.y-i.y)<a&&(i.fj_tk+=this.id,t.fj_jp+=r)},y.add=function(t){return new y(t)},y.getMoveStr=function(t,e){var i=Nt[t];return i?i.getMoveStr(e):null},y.loadMoveStr=function(t){var e,i=t[0],n=t.charCodeAt(1)-32768,o=t.charCodeAt(2)-32768,r=t.charCodeAt(3),a=63&r;return r>>=6,e=Nt[i],!!e&&(e.v=a,0==r?(e.v_v.x=e.v_v.y=0,e.mt_pst.x=n,e.mt_pst.y=o):(e.r=r,T.deg2vector(e.r,e.v_v),e.mt_pst.x=n+e.v_v.x*y.move_once_time*e.v*.01,e.mt_pst.y=o+e.v_v.y*y.move_once_time*e.v*.01),e.mt_t=(new Date).getTime()+y.move_once_time,e)},y.getZipStr=function(t){var e=Nt[t];return e?e.getZipStr():""},y.loadZipStr=function(t){var e,i={id:t[0],x:t.charCodeAt(1)-32768,y:t.charCodeAt(2)-32768,r:t.charCodeAt(3),p:t.charCodeAt(4),h:t.charCodeAt(5),f:!!(1&t.charCodeAt(6)),gun:t.charCodeAt(6)>>1};i.v=63&i.r,i.r=i.r>>6,0==Ct&&setTimeout(function(){Nt[i.id]&&R.emit("n",i.id)},1e3),e=y.add(i),2==Ct&&e.add_fj()},y.loadZipStrS=function(t){for(var e=0;e<t.length;e+=8)y.loadZipStr(t.substr(e,7))},y.remove=function(t){var e=Nt[t];e&&e.remove()},y.clear=function(){for(var t in Nt)Nt[t].remove()},y.setGUN=function(t,e){var i=Nt[t];i&&i.setGUN(e)},y.imove=function(){var t=0,e=!1;return function(i){i=Math.round(i),t!=i&&(t=i,e||(e=!0,setTimeout(function(){R.emit("r",String.fromCharCode(t)),e=!1},60)))}}(),y.ipao=function(){var t=0,e=!1;return function(i){i=Math.round(i),t!=i&&(t=i,e||(e=!0,setTimeout(function(){R.emit("p",String.fromCharCode(t)),e=!1},130)))}}(),y.setFireState=function(t,e){var i=Nt[t];i&&i.setF(e)},y.ibg=function(t){t-=0;var e=String.fromCharCode(t);R.emit("d",e)},y.ifire=function(){var t=!1;return function(e){e!=t&&(t=e,t?R.emit("f",""):R.emit("e",""))}}(),y.tickFire=function(t){var e,i,n,o,r,a,s;for(a in Nt)if(e=Nt[a],!(e.h<=0)&&e.f){if(!e.wp)for(e.wp=T.clone(E[e.gun]),s=0;s<e.wp.fires.length;s++)i=e.wp.fires[s],i.f_t=t+i.st;for(s in e.wp.fires)r=e.wp.fires[s],t>=r.f_t&&(r.f_t=t-(t-r.f_t)%r.tt+r.tt,r.fr!=e.p&&(r.fr=e.p,r.fx=r.tx*e.v_p.x-r.ty*e.v_p.y,r.fy=r.tx*e.v_p.y+r.ty*e.v_p.x),n=r.fx+e.x,o=r.fy+e.y,0==Ct&&g.add({fid:e.id,x:n,y:o,r:e.p+r.tr,k:r.k||1,t:r.ct||1e3,v:r.v||40,s_t:t,img:r.img||"zd0"}),2==Ct&&g.add({fid:e.id,x:n,y:o,r:e.p+r.tr,k:r.k||1,t:r.ct||1e3,v:r.v||40,s_t:t,fj_tk:e.fj_tk,fj_wt:e.fj_wt}))}},y.tickMove=function(t){var e,i,n,o,r,a=kt+100,s=St+100;for(r in Nt)i=Nt[r],i.a?(i.mt_t>i.m_t?(e=i.mt_t-i.m_t,n=i.mt_pst.x-i.v_v.x*e*i.v*.01,o=i.mt_pst.y-i.v_v.y*e*i.v*.01,i.x+=(n-i.x)/5,i.y+=(o-i.y)/5):(e=t-i.m_t,i.x+=i.v_v.x*e*i.v*.01,i.y+=i.v_v.y*e*i.v*.01,0==Ct&&0!=i.mt_t&&i.mt_t-i.m_t<-3e3&&i.h>0&&i.remove()),i.m_t=t,0==Ct&&r==Dt&&Gt!=i&&(Gt=i,i.n=V.userName),2==Ct&&(i.x>a||i.x<-a||i.y>s||i.y<-s)&&(wt.send("k"+i.id+i.id),i.a=!1)):i.remove()},y.tickMainMove=function(t){var e,i,n;for(n in Nt)i=Nt[n],i.a?(e=t-i.m_t,0!=i.r&&(i.x+=i.v_v.x*e*i.v*.01,i.y+=i.v_v.y*e*i.v*.01),i.m_t=t):i.remove()},y.tickAI=function(t){},y.a_tick=function(t){var e,i,n,o,r,a,s=1/0,d=null;for(a in Nt)i=Nt[a],i.a?(i.mt_t>i.m_t?(e=i.mt_t-i.m_t,n=i.mt_pst.x-i.v_v.x*e*i.v*.01,o=i.mt_pst.y-i.v_v.y*e*i.v*.01,i.x+=(n-i.x)/5,i.y+=(o-i.y)/5):(e=t-i.m_t,i.x+=i.v_v.x*e*i.v*.01,i.y+=i.v_v.y*e*i.v*.01,0==Ct&&0!=i.mt_t&&i.mt_t-i.m_t<-3e3&&i.h>0&&i.remove()),i.m_t=t,a==Dt&&Gt!=i&&(Gt=i),a!=Dt&&(r=Math.abs(i.x-Gt.x)+Math.abs(i.y-Gt.y),r<s&&(d=i,s=r))):i.remove();Tt=d,Rt=s},y.fj_ds=1200,y.fj_dswj=800,y.tick_fj=function(){var t,e,i,n,o,r,a,s,d,h=y.fj_ds,c=Object.keys(Nt),f=c.length-1;for(i in Nt)t=Nt[i],t.fj_tk="",t.fj_wt="",t.fj_jp="";for(n=0;n<f;n++)for(t=Nt[c[n]],o=n+1;o<c.length;o++)e=Nt[c[o]],Math.abs(t.x-e.x)<h&&Math.abs(t.y-e.y)<h&&(t.fj_tk+=c[o],e.fj_tk+=c[n]);h=y.fj_dswj;for(a in Lt){r=Lt[a],r.fj_tk="";for(i in Nt)t=Nt[i],Math.abs(t.x-r.x)<h&&Math.abs(t.y-r.y)<h&&(r.fj_tk+=i,t.fj_wt+=a)}for(d in qt){s=qt[d],s.fj_tk="";for(i in Nt)t=Nt[i],Math.abs(t.x-s.x)<h&&Math.abs(t.y-s.y)<h&&(s.fj_tk+=i,t.fj_jp+=d)}},y.tick_fj_t=function(){},Ht={a:function(){R.emit("a",V.userName)},b:function(t){Dt=t,m(),R.emit("g",""),R.emit("w","")},c:function(t){y.loadZipStrS(t)},d:function(t){y.remove(t)},e:function(t){y.setFireState(t,!1)},f:function(t){y.setFireState(t,!0)},g:function(t){v.loadZipStrS(t)},h:function(t){var e,i,n;0==Ct&&(e=t[1],i=t.charCodeAt(2),n=Lt[e],n&&(n.h=i))},i:function(t){var e,i;0==Ct&&(e=t[1],i=Lt[e],i&&(i.h=0,i.a=!1))},j:function(t){var e,i,n;0==Ct&&(e=t[1],i=t.charCodeAt(2),n=Nt[e],n&&(n.h=i,0==Ct&&e==Dt&&d()))},k:function(t){var e,i,n,o;0==Ct&&(e=t[0],i=t[1],o=Nt[i],o?(o.h=0,n=o.n||"player:"+i.charCodeAt(0)):n="player:"+i.charCodeAt(0),e==Dt&&(a("YOU",n),Gt.kill++),0==Ct&&i==Dt&&d())},m:function(t){var e,i=Nt[t.substr(0,1)];i?y.loadMoveStr(t):0===Ct&&(e=t.substr(0,1),R.emit("c",e))},n:function(t){var e=t[0],i=t.substr(1);Nt[e]&&(Nt[e].n=i)},p:function(t){var e=Nt[t[0]];e&&e.setP(t.charCodeAt(1))},r:function(t){var e=Nt[t[0]];e?e.setR(t.charCodeAt(1)):0===Ct&&R.emit("c",t.substr(0,1))},s:function(t){v.loadEffectStr(t)},t:function(t){var e=t[0],i=t.charCodeAt(1),n=t.charCodeAt(2),o=Nt[e];o&&(o.setGUN(i),o.setGold(n))},w:function(t){_.loadZipStrS(t)},x:function(t){0==Ct&&(Gt.idx=t.charCodeAt(0))},y:function(t){0==Ct&&c(t)},C:function(t){var e,i,n,o,r,a,s,d,h=t.charCodeAt(0),c=t.substr(1,h),f=t.substr(h+1);Gt.fj_wt=c,Gt.fj_jp=f,n="",o="";for(r in Lt)e=Lt[r],e.b=!1;for(a=0;a<c.length;a++)e=Lt[c[a]],e?e.b=!0:n+=c[a];for(r in Lt)e=Lt[r],e.b||(e.a=!1);for(s in qt)i=qt[s],i.b=!1;for(a=0;a<f.length;a++)i=qt[f[a]],i?i.b=!0:o+=f[a];for(s in qt)i=qt[s],i.b||i.chi||(i.a=!1);d=String.fromCharCode(n.length)+n,d+=o,d.length>1&&R.emit("D",d)},D:function(t){var e=t.charCodeAt(0),i=t.substr(1,e),n=t.substr(e+1);_.loadZipStrS(i),v.loadZipStrS(n)}},Jt=900,Vt=900,Kt=Jt,Qt=Vt,ie={},function(){function t(){for(W in Y)Y[W]=PIXI.Texture.fromImage(Y[W])}function e(){f.clear(),f.lineStyle(6,16711680,.3),f.drawRect(-kt,-St,kt<<1,St<<1),f.lineStyle(1,16711680,.3)}function i(t){var e,i,n,o,r,a,s,d,h,c,f,l,_,g,y=Gt.x-te,w=Gt.x+te,x=Gt.y-ee,b=Gt.y+ee,j=50,C=j/2,M=36,k=M/2,S=Math.round(dfd_speed_t/j),I=6.28;for(c in qt)n=qt[c],n.model||(n.model=new PIXI.Container,n.body=new PIXI.Sprite(Y[n.img]),n.body.anchor.set(.5,.5),n.model.addChild(n.body),0==n.t&&(f=new PIXI.Text("x"+n.z,{fontFamily:"Arial",fontSize:14,fill:16777215,align:"center"}),f.y=0,f.x=16,f.alpha=1,f.anchor.set(0,0),n.model.addChild(f)),u.addChild(n.model)),n.model.x=n.x,n.model.y=n.y,h=n.body.rotation,h+=.01,n.body.rotation=h>I?0:h,n.body.scale.set(n.chi_ct);for(l in Lt)o=Lt[l],o.model||(o.model=new PIXI.Container,m.addChild(o.model),o.body=new PIXI.Sprite(Y[o.img]),o.body.anchor.set(.5,.5),o.graphi=new PIXI.Graphics,o.model.addChild(o.graphi),o.model.addChild(o.body)),o.model.x=o.x,o.model.y=o.y,h=o.body.rotation,h-=.03,o.body.rotation=h<0?I:h,o.drowh!=o.h&&(o.graphi.clear(),o.h>0&&(a=24,r=-k,o.graphi.lineStyle(2,5906207,1),o.graphi.moveTo(r,a).lineTo(r+M,a),o.graphi.lineStyle(2,13505299,1),o.graphi.moveTo(r,a).lineTo(r+M*o.h/o.mh,a)),o.drowh=o.h);for(_ in Nt)e=Nt[_],e.model||(e.model=new PIXI.Container,p.addChild(e.model),e.body=new PIXI.Sprite(Y["fj"+e.skin]),e.body.anchor.set(.5,.5),e.model.addChild(e.body),e.graphi=new PIXI.Graphics,e.model.addChild(e.graphi)),e.paota||(e.paota=new PIXI.Sprite(Y[E[e.gun].p]),e.paota.anchor.set(.5,.5),e.model.addChild(e.paota)),!e.n_model&&e.n&&(f=new PIXI.Text(e.n,{fontFamily:"Arial",fontSize:13,fill:11184810,align:"left"}),f.x=30,f.y=5,f.alpha=1,e.model.addChild(f),e.n_model=!0),e.model.x=e.x,e.model.y=e.y,e.c_r!=e.r&&(e.r-e.c_r>180?e.c_r+=360:e.r-e.c_r<-180&&(e.c_r-=360),s=e.r-e.c_r,s>30?s=30:s<-30?s=-30:0,e.c_r+=s/6,e.body.rotation=Math.PI*e.c_r/180),e.c_p!=e.p&&(e.p-e.c_p>180?e.c_p+=360:e.p-e.c_p<-180&&(e.c_p-=360),d=e.p-e.c_p,e.c_p+=d/6,e.paota.rotation=Math.PI*e.c_p/180),e.graphi.clear(),e.h>0&&e.x>y&&e.x<w&&e.y>x&&e.y<b&&(a=30,r=-C,e.graphi.clear(),e.graphi.lineStyle(4,1856552,1),e.graphi.moveTo(r,a).lineTo(r+j,a),e.graphi.lineStyle(4,3722771,1),e.graphi.moveTo(r,a).lineTo(r+j*e.h/$t,a),e.v_t>t&&(a+=5,e.graphi.lineStyle(4,2854870,1),e.graphi.moveTo(r,a).lineTo(r+Math.floor((e.v_t-t)/S),a))),e.h<=0&&(e.model.scale.set(Math.min(e.model.scale.x+.02,1.5)),e.model.alpha-=.01,e.model.alpha<=.05&&(e.a=!1));for(g=0;g<Ot.length;g++)i=Ot[g],i.model||(i.model=new PIXI.Sprite(Y[i.img]),i.model.anchor.set(.5,.5),v.addChild(i.model)),i.model.x=i.x,i.model.y=i.y,i.model.rotation=Math.PI*i.r/180,i.model.visible=i.a}function n(){if(requestAnimationFrame(n),2==V.sysstate){var t=(new Date).getTime();w(),Yt.x=te-Gt.x,Yt.y=ee-Gt.y,_(),i(t),Bt.render(Wt)}}function o(){function t(t){var e,i,n,o,r,a,s=0,d=0;if("mousemove"==t.type)s=t.pageX,d=t.pageY;else if("touchstart"==t.type||"touchmove"==t.type){for(e=t.touches[0],n=1;n<t.touches.length;n++)i=t.touches[n],i.pageX>e.pageX&&(e=i);s=e.pageX,d=e.pageY}o=s-Kt/2,r=d-Qt/2,a=Math.round(T.vector2deg(o,r)),y.ipao(a%360)}function e(t){"mousedown"==t.type?y.ifire(!0):"mouseup"==t.type?y.ifire(!1):"touchstart"==t.type?y.ifire(!0):"touchend"==t.type&&y.ifire(!1)}function i(t){var e,i,o,r,a,s,d,h;if("touchmove"==t.type||"touchstart"==t.type){for(n=!0,e=t.touches[0],console.log(t.touches),o=1;o<t.touches.length;o++)i=t.touches[o],i.pageX<e.pageX&&(e=i);r=e.pageX,a=e.pageY,s=r-g,d=a-x,h=Math.round(T.vector2deg(s,d)),y.imove(h),t.stopPropagation(),t.preventDefault()}else n=!1,y.imove(0)}$(document).on("keydown",function(t){ie[t.which]||(ie[t.which]=!0,j(32==t.which?2:1))}),$(document).on("keyup",function(t){ie[t.which]=!1,j(32==t.which?2:1),13==t.which&&2==V.sysstate&&rt.focus()}),s.addEventListener("touchstart",t),s.addEventListener("touchmove",t),s.addEventListener("mousemove",t),s.addEventListener("mousedown",e),s.addEventListener("mouseup",e),s.addEventListener("touchstart",e),s.addEventListener("touchend",e);var n=!1;at||(b[0].addEventListener("touchstart",i),b[0].addEventListener("touchmove",i),b[0].addEventListener("touchend",i))}function r(){if(Kt=s.clientWidth,Qt=s.clientHeight,Jt=Kt,Vt=Qt,te=Jt>>1,ee=Vt>>1,Bt.resize(Jt,Vt),h.width=Jt,h.height=Vt,!at){var t=b.offset();g=Math.round(t.left)+34,x=Math.round(t.top)+34}}function a(){r(),e(),o(),n()}var s,d,h,c,f,l,u,m,p,v,_,g,x,b,j;t(),s=document.getElementById("js-canvas-cont"),Bt=PIXI.autoDetectRenderer(Jt,Vt,{transparent:!0}),s.appendChild(Bt.view),Yt=new PIXI.Container,Wt=new PIXI.Container,d=PIXI.Texture.fromImage(H),h=new PIXI.extras.TilingSprite(d,Jt,Vt),c=new PIXI.Graphics,Wt.addChild(h),Wt.addChild(Yt),Wt.addChild(c),f=new PIXI.Graphics,l=new PIXI.Graphics,Yt.addChild(f),Yt.addChild(l),u=new PIXI.Container,Yt.addChild(u),m=new PIXI.Container,Yt.addChild(m),p=new PIXI.Container,Yt.addChild(p),v=new PIXI.Container,Yt.addChild(v),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame,_=function(){var t,e,i=80,n=i/kt,o=St*n;return base_x=i+0,base_y=o+0,function(){var r,a;Gt&&(h.tilePosition.x=Math.round(-Gt.x)+te,h.tilePosition.y=Math.round(-Gt.y)+ee),c.clear(),c.beginFill(0,.5),c.drawRect(-i+base_x,-o+base_y,i<<1,o<<1),c.endFill(),c.lineStyle(1,6710886,.1),c.beginFill(0,.5),c.drawCircle(base_x,base_y,i-10),c.endFill(),c.lineStyle(1,16711680,.4),c.beginFill(16724787,.6);for(r in Nt)t=Nt[r],c.drawCircle(t.x*n+base_x,t.y*n+base_y,2);c.endFill(),c.lineStyle(0,16711935,.2),c.beginFill(16750899,.6);for(a in Lt)e=Lt[a],c.drawCircle(e.x*n+base_x,e.y*n+base_y,1);c.endFill(),c.beginFill(3381759,.6);for(a in qt)e=qt[a],c.drawCircle(e.x*n+base_x,e.y*n+base_y,1);c.endFill(),c.lineStyle(1,65280,.4),c.beginFill(65331,.6),c.drawCircle(Gt.x*n+base_x,Gt.y*n+base_y,3),c.endFill()}}(),b=$("#js-touch-bar"),j=function(){var t,e,i,n,o,r,a=0,s=!1;return function(d){var h,c;2==V.sysstate&&(1==d?(t=ie[87]||ie[38],e=ie[83]||ie[40],i=ie[65]||ie[37],n=ie[68]||ie[39],r=t&&!e?-1:!t&&e?1:0,o=i&&!n?-1:!i&&n?1:0,h=360,h=o>0?r>0?45:r<0?315:360:o<0?r>0?135:r<0?225:180:r>0?90:r<0?270:0,h!=a&&(y.imove(h),a=h)):2==d&&(c=ie[32]||ie.f,c!=s&&(s=c)))}}(),a(),window.onresize=r}()}();